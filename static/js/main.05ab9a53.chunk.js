(this.webpackJsonpetherstream_client=this.webpackJsonpetherstream_client||[]).push([[0],[,,,,,,,,,,,,,function(e,t,n){e.exports=n(28)},,,,,function(e,t,n){},,function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(10),s=n.n(c);n(18),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var o=n(1),i=r.a.createContext({}),u=n(8),l=n(2),m=n.n(l),b=n(5),f=n(11),h=n(12),v=function(){},p=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=n.onOpen,r=void 0===a?v:a,c=n.onClose,s=void 0===c?v:c,o=n.onError,i=void 0===o?v:o;Object(f.a)(this,e),this.url=t,this.waitingRequests={},this.subscriptions={},this.timeout=1e4,this.onOpen=r,this.onClose=s,this.onError=i}return Object(h.a)(e,[{key:"connect",value:function(){var e=this;this.socket=new WebSocket(this.url),this.socket.onopen=function(){return console.log("connected")||e.onOpen()},this.socket.onclose=function(){return e.onClose()},this.socket.onerror=function(t){return e.onError(t)},this.socket.onmessage=function(t){return e.handleMessage(JSON.parse(t.data)).catch(console.error)}}},{key:"handleMessage",value:function(){var e=Object(b.a)(m.a.mark((function e(t){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.waitingRequests[t.requestID]){e.next=11;break}return e.prev=1,e.next=4,this.waitingRequests[t.requestID](t);case 4:e.next=9;break;case 6:e.prev=6,e.t0=e.catch(1),console.error("Error handling request from message ".concat(JSON.stringify(t)));case 9:e.next=20;break;case 11:if(!this.subscriptions[t.subscriptionID]){e.next=20;break}return e.prev=12,e.next=15,this.subscriptions[t.subscriptionID](t);case 15:e.next=20;break;case 17:e.prev=17,e.t1=e.catch(12),console.error("Error handling subscription from message ".concat(JSON.stringify(t)));case 20:case"end":return e.stop()}}),e,this,[[1,6],[12,17]])})));return function(t){return e.apply(this,arguments)}}()},{key:"send",value:function(e){var t=this;return new Promise((function(n,a){var r=e.requestID||t.makeRequestID();e=Object(u.a)({requestID:r},e),t.waitingRequests[r]=function(e){n(e),delete t.waitingRequests[r]},setTimeout((function(){return a(new Error("Request ".concat(r," timed out after ").concat(t.timeout," ms")))}),t.timeout),t.socket.send(JSON.stringify(e))}))}},{key:"subscribe",value:function(e,t){var n=e.subscriptionID||this.makeRequestID();return this.subscriptions[n]=function(e){return t(e)},this.send(Object(u.a)({action:"subscribe",subscriptionID:n},e))}},{key:"makeRequestID",value:function(){return"".concat(Date.now(),"-").concat(Math.floor(1e6*Math.random()))}}]),e}(),d=n(7);n(20),n(21),n(22);function g(){return r.a.createElement("header",{className:"Header-header"},r.a.createElement("h1",{className:"Header-title"},"Etherstream"),r.a.createElement("div",{className:"Header-paragraph"},"Stream ethereum event logs. Made by ",r.a.createElement("a",{href:"http://elliotplant.com"},"Elliot Plant"),"."))}n(23);var E=n(6);n(24);function O(e){var t=e.children,n=e.className,a=void 0===n?"":n,c=Object(E.a)(e,["children","className"]);return r.a.createElement("button",Object.assign({className:"".concat(a," Button-button")},c),t)}n(25);function k(e){e.children;var t=e.className,n=void 0===t?"":t,a=Object(E.a)(e,["children","className"]);return r.a.createElement("input",Object.assign({className:"".concat(n," Input-input")},a))}var S=localStorage.getItem("address")||"",j=localStorage.getItem("topic")||"";var N=function(e){var t=e.subscribe,n=Object(a.useState)(S),c=Object(o.a)(n,2),s=c[0],i=c[1],u=Object(a.useState)(j),l=Object(o.a)(u,2),m=l[0],b=l[1];return r.a.createElement("form",{className:"SubscribeForm-form"},r.a.createElement("label",{className:"SubscribeForm-label"},r.a.createElement("span",{className:"SubscribeForm-label-text"},"Address"),r.a.createElement(k,{className:"SubscribeForm-input",placeholder:"0x123...",value:s,onChange:function(e){return function(e){i(e),localStorage.setItem("address",e)}(e.target.value)}})),r.a.createElement("label",{className:"SubscribeForm-label"},r.a.createElement("span",{className:"SubscribeForm-label-text"},"Topic"),r.a.createElement(k,{className:"SubscribeForm-input",placeholder:"0x123...",value:m,onChange:function(e){return function(e){b(e),localStorage.setItem("topic",e)}(e.target.value)}})),r.a.createElement(O,{className:"SubscribeForm-button",type:"button",onClick:function(){return t(s,m)}},"Subscribe"))};n(26),n(27);var w=function(e){var t=e.event;return r.a.createElement("li",{className:"Event-li"},r.a.createElement("code",{className:"Event-code"},t))};var x=function(e){var t=e.events,n=void 0===t?[]:t;return r.a.createElement("ul",{className:"Events-ul"},n.map((function(e){return r.a.createElement(w,{key:e.id,event:e})})))};var I=function(e){var t=e.socketConnected,n=Object(a.useState)([]),c=Object(o.a)(n,2),s=c[0],u=c[1],l=Object(a.useState)(null),f=Object(o.a)(l,2),h=f[0],v=f[1],p=Object(a.useState)([]),E=Object(o.a)(p,2),O=E[0],k=E[1],S=Object(a.useContext)(i),j=function(){var e=Object(b.a)(m.a.mark((function e(t,n){var a;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("subscribing",t,n),e.prev=1,e.next=4,S.subscribe({address:t,topic:n},(function(e){var t=e.event;u((function(e){return[t].concat(Object(d.a)(e.slice(0,10)))}))}));case 4:a=e.sent,k([a].concat(Object(d.a)(O))),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(1),console.error(e.t0),v(e.t0);case 12:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t,n){return e.apply(this,arguments)}}();return r.a.createElement(r.a.Fragment,null,r.a.createElement(g,null),t?r.a.createElement(N,{subscribe:j}):r.a.createElement("p",{style:{textAlign:"center"}},"Connecting to server"),h&&r.a.createElement("p",null,h.message),O.map((function(e){return r.a.createElement("div",{key:e.subscriptionID},e.subscriptionID)})),r.a.createElement(x,{events:s}))},y=null;function q(){var e=Object(a.useState)(!1),t=Object(o.a)(e,2),n=t[0],c=t[1];return y||(y=new p("ws://api.etherstream.io")).connect(),y.onOpen=function(){return c(!0)},y.onClose=function(){return c(!1)},r.a.createElement(i.Provider,{value:y},r.a.createElement(I,{socketConnected:n}))}s.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(q,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}],[[13,1,2]]]);
//# sourceMappingURL=main.05ab9a53.chunk.js.map